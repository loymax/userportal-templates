<div class="container feedback">
    <section>
        <h2>{{'feedback.title' | translate}}</h2>
        <notifications area="feedback"></notifications>

        <div loader="inProgress && messages === undefined">
            <div ng-show="!inProgress || messages !== undefined">
                <div class="hint">
                    <p>{{'feedback.askQuestion' | translate}}:</p>
                </div>

                <form novalidate name="feedbackForm" ng-submit="feedbackForm.$valid && send(feedbackForm)">
                    <form-group>
                        <textarea
                            ng-disabled="sendInProgress"
                            id="msgTextarea" name="msgTextarea"
                            ng-model="messageModel.text"
                            placeholder="{{'feedback.typeText' | translate}}"
                            required
                        >
                        </textarea>
                    </form-group>

                    <inline-loader line>sendInProgress</inline-loader>

                    <div class="file-input-and-submitter clearfix margin-bottom" ng-if="!sendInProgress">
                        <file-input ng-model="messageModel.attachment" class="left"></file-input>
                        <button type="submit" class="right row">{{'buttons.send' | translate}}</button>
                    </div>
                </form>

                <div class="message-history" loader="sendInProgress || inProgress">
                    <lmx-scroller>
                        <div class="chat-message-line clearfix" ng-repeat="item in messages track by item.message.id">
                            <div ng-class="{'outcoming': item.isUserMessage}" class="chat-message">
                                <div class="from">{{'feedback.' + (item.isUserMessage ? 'you' : 'operator') | translate}}</div>
                                <div class="text">{{::item.message.message}}</div>
                                <div class="file-name" ng-if="item.message.fileName">{{'feedback.file' | translate}}: {{::item.message.fileName}}
                                </div>
                                <div class="date">{{::item.message.dateTime | toUTC | shortDateTime}}</div>
                            </div>
                        </div>
                    </lmx-scroller>
                </div>
            </div>
        </div>
    </section>
</div>
